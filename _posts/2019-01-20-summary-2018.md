---
title: 2018年总结与反思——行动力与积累，也谈谈安全圈一点怪象
description: 2018年，总结与反思
categories:
 - 总结与反思
tags:
 - 总结与反思
---

### 0x00 先聊聊自己
#### 几个片段
*片段一*

说起来也很怪，我们公司这么重视安全运营，50多个人的安全部了，我来上班前连一个外网扫描器都没有，不要说扫应用的扫描器，连个扫端口的都没有，好嘛，做个扫描器，先把非业务的端口全关了，免得把DB暴露出去

问了下IP列表，哦，没有？给了我几个网段加一点IP加一点域名

有CMDB吗，有？那为啥给我这个，不从CMDB拉数据？哦，CMDB不提供接口

那可以让它提供一个接口吗？哦，不可以，因为CMDB不是我们安全部管的，提不了需求

那可以让老板去协商一下吗？哦，可以，你自己去跟老板说，我。。。

好吧，我也是初生牛犊不怕虎，老板，可以提供一下吗？哦，可以，你自己去和CMDB说，你要学会自己推动，我。。。

CMDB的部门，可以提供一下吗？哦，可以啊，我们也正想做这个功能，这样吧，给你排期到两年以后，如果中间没什么其他需求的话，我MMP

算了算了，再回去问老板，老板也不帮忙争取，我就拿最开始的列表做一下好了，虽然不一定全，总比没有好

扫了扫了，没太大问题，700多个开放端口也没几个是DB的，还好，提单限制就是了

*片段二*

有个项目要上线了，我来做渗透，哎，这里有个Struts2的RCE漏洞，叫业务修复，也就是升级，升级完上线

例会上说了下这个事，报告了一下，boss似乎懂点技术啊，知道Struts2，还问是不是可以不让业务用，让我们想办法运营一下这个问题

后来回去翻了翻安全部文档，还真有不准使用Struts2框架，问了写文档的人，啊，我也不知道啊，这个文档不知道从哪里抄的，那你这个规范有效吗，啊，我也不知道啊，我就负责写写，呵呵呵

好嘛，确认一下，有效，那有规定，让业务直接换框架，这个时候其实我是很不好意思的，人家都写完了上线了，让业务换框架，内心无比羞愧，唉，后来业务报备了一下，不想换，老板通过了，规范可以这样就不管吗，那老板会上不让用是为什么，我感觉智商受到了侮辱

好嘛，老板的要求是运营，那就各个阶段要加限制喽

我们公司是没有SDL的，也不能说没有SDL，就是介于有和没有之间，薛定谔的SDL，感觉这个问题的运营就业务构架设计的时候介入一下，然后外网扫描期每日扫一下就好了呗，HIDS那边也不是我们组负责，知会他们一下

问了一下，业务构架就是老板审核，问了下老板，意思是你们渗透的时候检查就好了啊，不需要构架的时候不让它用，我说这样对业务不友好吧，他都做好了等上线了跟他说不行，老板说没关系，公司现状这样，快速迭代

好嘛，反正到时候有问题是渗透没测出来，测出来反正我跟业务说要他换个框架，我去被业务怼，也不是老板你，反正怼到最后业务报备了，哪天Struts2又出新漏洞也是渗透没做好。。。

然后就Struts2外网扫描搞起，资产列表的问题和片段一一样，我觉得是运营不好的，说下了资产问题，说了下我写的指纹识别和PoC也可能会因为网络限制、路径找不到等问题没检测出来，老板说没关系，有运营就好了

后来又有一次Struts2被白帽子搞到，估计帐也是被老板记在我们头上的

*片段三*

前面讲到Struts2扫描，Web一扫，嗯，没扫出来，希望不是我扫描器能力不行啦

实在害怕出事情背锅，分析一下请求返回，反正700多个外部端口，也不是很多，看一下，好多501啊，问安全部的大家大家不知道

去问业务干啥用501，业务说自己的业务没有501啊，业务也奇怪，业务自己去找原因了，哦，原来是你们安全部的Web WAF拦了，我，羞愧难当

卧槽，原来我们自己部署的Web WAF，我们部署的人不知道它怎么拦的呀，真惊呆

原来有Web WAF拦Struts2的PoC规则，那还扫个屁，那WAF拦就好了，不行我们要纵深防御，那我让BOSS在构架的时候查查怎么不是纵深防御了，算了，我是小兵，给我扫描的IP加个白名单吧，啥，不知道怎么加。。。

在看一下，700多个业务还有好多不是501的呢，这个又是为什么呀，查了一圈，哦，WAF未生效，管WAF的去处理了，经过一年半的运营，Web WAF一直不能全部生效。。。

*片段四*

外网资产列表也要定期更新，啥，CMDB提供接口啦，这么牛掰的嘛

卧槽，一年过去了，出现了4个CMDB，原来是CMDB问题终于受到各个小组重视，于是，安全部运维自己搞了个CMDB，HIDS组自己搞了一个，做域名暴破的同学自己又弄了一个，卧槽，还不算其他部门的

那怎么办呢，我以哪个为准呢，导师说你全部拉全部扫不就是了，哪个记录的不对你自己做个程序判断出来，哪个接口挂了你告警出来让他们去修，你自己本地再存一份，反正每天保证稳定运营，我TM拉个资产你又让我做个CMDB出来，还要保证友商CMDB不挂。。。

CMDB里还有内网机器的数据，啥，内网分了3个大区，其中最小那个区分了24个网段，每个段要扫描必须要单独申请策略和机器，Boss这么说的，那我要整体扫描下内网，还得部署几十台机器的程序，都要漫长的策略申请还要保证它们每天运营好。。。

Boss命难为，我自己来，申请了一台，哎，你这个网段这台机器要扫描的怎么不通啊，哦，你网络防火墙配置错误，哦，你配置变化了，那我怎么赶上你的变化呢，啥，我出问题了在跟你确认？这么多网段我怎么知道有没有出问题，哦，我自己看着办

不止运维网络的不知道网络是怎么划分的，防火墙策略是否生效全看业务反馈是不是没通，还有更厉害，我导师因为怕一些和主要业务没关系的服务出现漏洞影响整体，让这么业务自己出钱去买机器，不要通过公司流程，那这么怎么计入CMDB呢

*片段五*

别的部门一起入职的小伙伴说的，他想用下citrix看生产数据，然后照着指引申请，还是不能看到，于是他找负责人，负责人也不知道怎么办，于是负责人让他把所有的权限都申请了一遍

申请了个把月，终于可以用了，他很害怕，因为他一个一点技术都不懂的产品经理还把运维权限给申请了，还要经过大领导，他和我一样的小透明很害怕

总之就是定规定的人不知道怎么申请可以满足需要，要权限的人只能把所有权限都申请了，申请时间已经超过他们业务可以接受的范围之内，然后权限也赋予了不该有的人

然后肯定不久之后又会发现什么问题要运营起来。。。

#### 我们公司的安全运营
安全运营是我一毕业就每次例会都会都老板强调的，实际上听起来还是很认同安全运营的理念的，当然其实我感觉我们这个老板这么重视安全运营的公司里安全运营做得很差

实际上我在信息安全专业读书的时候还没有安全运营这个概念，那时候大学老师也知道的是SDL，据说安全运营的概念来自美团大佬职业欠钱的这几篇文章：[我理解的安全运营](https://zhuanlan.zhihu.com/p/39467201)、[再谈安全运营](https://zhuanlan.zhihu.com/p/84591095)、[谈一谈安全运营工作是什么](https://www.freebuf.com/company-information/215676.html)

其实我看了是很赞同文章中的这些意思的，所以我老板说要重视安全运营我也是赞同的，然而大家一直在强调安全运营，安全运营却一直做不好

就如同上面的几个片段，作为一个底层工作者，我时常感觉到存在很多问题，并且这些问题挤满了我平时的工作，很多比如CMDB、网段划分，很多可以自动化的东西不能自动化，原本的负责人负责不了，如果要准确的数据，必须自己完全继承对方的工作，然后为了临时完成老板要求的一些运营工作，所以自己维护的不知道数据准确的CMDB这种系统开始出现，并且多个团队不合作不互通

运营没有闭环，只是觉得运营事项越来越多，大多并非运用技术而是人工去顶，事情多了，之前运营起来的事项就是继续失效，进入了新的循环

#### 分析分析问题在哪里
首先是基础建设的垃圾

不如说是没有基础，就开始运营，原本美团大佬的文章里说运营火起来是因为大家基础建设差不多完了，运营依赖基础，不依赖基础的话，依靠人工，就会越来越乱，然后出现更多问题，CMDB资产不对，WAF部署不完整，防火墙规则不确定，文档没有执行等等

说白了，基础建设就啥都没做好，然后就想要运营达到闭环，所以连关键的卡口都找不到，想到哪里运营到哪里，全凭拍脑袋

然后是运营理念

`为了实现安全目标，提出安全解决构想、验证效果、分析问题、诊断问题、协调资源解决问题并持续迭代优化的过程`，这些职业欠钱大佬文章里提到的需要

我觉得安全运营的出现，很多可能是技术手段覆盖不到的问题，只能人工发现运营起来，闭环后添加到原来的自动化的安全产品中，运营人员的技术栈也和普通漏洞分析、渗透测试或者安全防护产品开发的技术栈不一样

随之而来的这些非运营人员来做运营，对运营本身的概念和流程都是不太理解，我其实干了一年多，也看了很多文章，还是不能说我确实清晰认识安全运营到底是什么，怎么做，而本身作为安全工程师，没有跟进运营书籍等运营方面的知识是我的懈怠

而对于像我公司的Boss来说，安全运营的理念其实是安全的银弹，只要持续把所有能发现的安全问题都闭环检测起来，就可以覆盖所有安全问题，这么听其实也没错，但是随之而来的技术基础不足和人力问题，也是想这么做必须解决的问题，同时没有建设上的轻重缓急，完全时间驱动

最后是公司氛围

一个是不重视技术，表现出来就是安全构架和项目管理的失败，基本能靠人工的问题用人工跟上，能马上解决的问题马上解决，不考虑以后的扩展性，完全没有工程的思维，我导师对我的一个并发不会超过10个人的小组使用的系统说"你不要用flask写，我怕性能不够，要用nginx写"，不知道他知不知道性能瓶颈是怎么来的

一个是办公室斗争，说真的，一个安全部，几十个人了，各路职责可以做到完全隔离，也是很厉害的，一个安全部的CMDB就有3、4个，那完全没有信息共享怎么做安全呢，不出事就好了，其他随便各个小组做，对老板汇报好就好

再说几个牛逼的点

* 我们有一个数据库审计，据说用机器学习审计SQL注入，做这个的是数据分析的同学，他不懂应用安全，有次他问我问题，我不是很懂数据分析机器学习，但我发现了他的SQL审计的负样本里连一条真正SQL注入的样本都没有，不知道他怎么收集的，所以这个系统也从来没告过警
* 部署Web WAF不知道501是被WAF拦截的肆意
* 因为构架上不考虑扩展性，人工跟进，慢慢就跟不上，跟不上就招人，有钱的公司就是不用考虑成本问题

#### 自身感受
不止上面说的这些，总之，运营变味了，没有闭环问题，还不断通过运营制造新的问题，更重要的是干的不愉快

美团职业欠钱大佬的文章里说的

> 这时候产生了大量的“杂活”，让安全工程师去一一解决，一方面他不喜欢做这些“非技术”的工作，另一方面，他的能力模型也不一定胜任

实际上，要恰饭的，不干"杂活"不行，我这样的也是懂的，不是一定要做技术的事情，但是，这"非技术"的事情也太多了吧，基本除了集成开源程序，没有技术的成分，集成开源程序又有几分技术含量呢

换句话说，是因为我们安全建设不需要很好的安全技术吗，当然不是，是有了技术也不知道用哪里，因为可见的问题太多，根本顾不上不可见的问题，而且老板倡导的运营没有主次轻重之分，并没有故意要大力建设某个模块，对发生的问题有一个临时解决方案就可以

这一年半，发现了很多问题，都需要运营去解决，但是如同我上面说的基础和配合等问题，运营这些，花的大力气在沟通和推动上，并且最后还可能只能达到一个不怎么好的闭环，留下更多的问题和隐患

而且，团队技术积累也越来越差，更重要的是，老板还觉得发现了很多问题，技术积累越来越好了，哈哈

这一年半，我职责是个做渗透和扫描器的，700个项目上线要渗透，还有周期渗透保证渗透效果，还要写扫描器，运营发现的各种问题，还要自己完成闭环，老板说法，你要学会自己推动，说技术没进步，老板说法，是你自己的问题，绩效没有拿到很好，老板说法，前人以前做得多先给他们你等几年

搞了很多，加班很多，自己觉得自己搞的没什么意义，反正基础没做好就做不到真正闭环，也很没意思，除了写扫描器的一些漏洞误报漏报看看有没有什么方法可以处理，基本没有从工作中获得技术进步，全靠业余学习

技术债迟早有一天是要还的，最可怕的事情是怕自己没有进步

### 0x01 说说饭局听到的
#### 再一些片段
同一个专业毕业的同学们，还有新毕业的学弟们，还有跟乙方一些负责人聊天，随着入行变久，也能慢慢了解其他公司的情况

*片段一*

试用安全产品的时候问了乙方小兵几个漏报误报问题，后来小兵答不上来，找来的了产品总监，大致正面回答了我一些问题

然后说起他们SDL咨询业务，就说其实不用懂SDL，只要了解大致流程能说就行，其实就是说他们的咨询也是随便做的咨询，其实也没有什么好办法或者经验，但是一般公司大老板就是相信的是别人的经验，所以只要和一些大公司有合作，就可以放肆吹

然后说起安全产品，就说其实各家都一样，大多数买产品的都不会用产品，接着就说它们产品的几个小功能，就说这些功能其实很重要，都要甲方自己根据自己的情况配规则，默认规则反而不重要，但是这些反而没有甲方问，各家谁能提供规则扩展方式，让甲方自己运营才算好产品，但是大多数甲方就买了个壳子，也不会用，就将就着了，像我这样提漏报误报问题的实在太少了

最后离开的时候还不忘挖角，给我名片说以后想动动了联系

*片段二*

同学在一家比较牛逼的独角兽公司

他说他也不知道自己干什么，什么基础设施都有，也没什么任务，每周只要周五工作半天，主要工作是想半天怎么憋周报，就这样，他小组3个人还只有他一个人在工作，偶尔完成些任务，其他两个一个是领导，一个是40多岁了的职级还和自己差不多，每次就拿他做的事情去汇报

有钱的公司还是牛逼啊，闲人养的一点没问题

*片段三*

两个学弟在两家有钱的公司，反正就是疯狂扩招人，他们作为应届生进去，进去就是问你们想要做什么，然后想做什么就让他们做什么

也就是招人的时候也不知道招人了要干啥，反正上一级要升职，就得有下属，但是又没有什么计划，就招了人问，问了再做，做完了再拿去升职

安全和产品不同，有时候不需要靠产出招人，全靠各大公众号吹牛，靠公安部护网行动，我们公司也这样

*片段四*

一同学在乙方实验室，部门不需要做什么事，主要是看书学习，9个月后整个部门被裁了，真是不知道之前是怎么撑过这9个月的

*片段五*

一同学领导是腾讯工作6、7年的，说自己是3Q大战主力，说金刚一开始就是他写的，用公司经费买了IDA这些，虽然他们公司用不上逆向

平时的工作就是骂我同学，基本上就是这个领导全接连扫描是什么意思都不知道，跟他讲一些术语他都不懂，有时候同学坚持什么是对的，然后领导就说他不对，也不说他哪里不对，就让他去学习，想明白哪里不对

江湖骗子吧

*片段六*

一学弟安全部5个人，2个领导3个小兵，两个领导谁也不服谁，3个小兵一分配就想干什么干什么，5个人也不合作不联系，看起来就是做安全完全不需要和业务有合作那种

*片段七*

一同学去面试一个独角兽公司，基本就是全程不问简历，社招一开始还要笔试，笔试完马上进入面试，就问答错的题目，不问简历不问答对的题目，感觉像是羞辱人，一下还要设计协议，牛逼的不行，笔试时候同学把排查入侵的每个步骤都写了，对方硬说没有思路，也不知道对方的指的思路是什么意思

然后到同学问问题了，就问对方安全不建设什么，基本上就是渗透外包给乙方、WAF、IDS也是买的，然后业务就一个，平常就想怎么在Cookie被人获取以后防止盗号，想说这是风控的事情吧，风控又有专门部门负责，也不知道这个应用安全的职位是干什么的

。。。等等片段

#### 再来分析分析
一开始我写文章的时候觉得是不是我工作不愉快，所以负能量比较满，怎么就没有入行以后干的比较愉快的同学，后来发现，至少应用安全这一块还真没有，我自己的公司算是不错的了，虽然大Boss不是很懂，但还是有一个大方向上的规划，中层虽然不是当领导的料，但是和我一样的底层员工还是有很多人有技术的

国家这些年越来越重视网络空间信息安全，各个公司也是，从大到小，无一例外

一些中小公司，甚至是一些大公司，招人的方式是HR或者CTO招个负责人，然后给资源任由负责人发展，HR或者CTO检测的标准也很简单，不出事

HR或者CTO怎么招人呢，他们也不懂安全，就算厉害的开发，也很少能完全明白反序列化漏洞的，所以一个人的经历远大于他的能力

BAT这些大公司出来的就算是坨屎也被当成金子看，甚至很多把SDL建设中的测试方的安全员作为大神来请求当负责人

就有很多像上面片段五这样的江湖骗子

也有很多不是江湖骗子的，但是很多做渗透的，做某一方面安全的，既不会管理也不会构架或者安全建设，很多都是摸索前进，主要不出事

正好也没有什么检验方式，现在随着开发框架的演进，很多问题不是那么容易出现的，没有厉害的通杀EXP，想直接被勒索软件锁内网还是比较难的，只要做个外网端口扫描，很多问题都没有了

所以干的不开心的无非就是我们这些有点梦想的小兵了，其实这种效果还是让我、我同学和学弟这些毕业生有些心寒的，只能积蓄能量，变强才有更多选择

### 0x01 行动力
有机会去面试了一些社招和应届生，有一些觉得面试的时候对漏洞的理解不行，编程可能也只是写写`Requests`，但是他们可能SRC挖漏洞一年挖30W

就是行动力吧，不管脚本小子也好，二进制大佬也好，实际上除非团队特别牛逼，工作中更多的还是拧螺丝，脚本小子会多用一些工具，看到站点就上去搞，行动力越强，其实产出也越强，毕竟企业不是为技术水平招人

我可能就是行动力太弱了，做事情之前需要考虑很多，怎么样才能做好，所以有些事没有一鼓作气又没有deadline就容易延后到完不成

恐怕做安全的这样不是很好，很多时候不管需求好不好，先去做也是很重要的一种能力吧

### 0x02 积累
内功还是要修行好

就像学Java反序列化漏洞，对Java不了解，对反射这些语法不明白，去看别人抄来抄去的`CommonsCollections`文章，肯定不清不楚不够明白

这时候更要静下心来，不明白回去学学基础，学学漏洞产生的历史原因，学学文档，再回过头看就容易明白

一定要稳住，不要因为眼前的困难就犹豫或者放弃
