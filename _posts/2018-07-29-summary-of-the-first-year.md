---
title: 工作第一年总结
description: 一年以来的工作感想，经验
categories:
 - 总结
tags:
 - 总结
---

2017.07.29—2018.07.29 工作满一周年，有一些心得、一些疑问和一些思考，然后就这一年做的渗透测试、安全开发和安全运营谈谈自己的想法

### 背景
#### 个人介绍
我是信息安全专业毕业的本科生，在校主学计算机基础课程和特色课程密码学、信息隐藏一类，这方面自认课业成绩在同校同期中较为优秀，同时自学过一些网络安全和Web安全相关知识，这方面只是了解漏洞成因但缺乏实战。毕业后进入甲方作为一名应用安全工程师，负责项目上线前渗透测试和应用安全运营。

#### 工作细分
工作一年间，负责项目上线前渗透测试和应用安全运营，下面分别对这两个大模块进行细分说明。

上线前渗透测试这个工作可以分为3个部分
* 一是上线前的漏洞发现，也就是普通渗透测试
* 二是漏洞修复流程优化，也就是对漏洞上报、修复、统计流程进行优化
* 三是工具打造，也就是对一些工具进行预研、引进，或者自研，以及针对一些业务定制插件

安全运营这方面可以分为2个部分
* 一是安全开发流程(SDL)建设，主要负责对渗透测试及漏洞相关知识普及，包括课程培训和漏洞介绍、修复文章编写，组成文档
* 二是扫描器运营，也就是部署扫描器对外网业务的定期扫描。

大致细分上面一些，其他有各种杂七杂八的活儿，就不细说了。

### 绩效思考
#### 工作职责
工作最主要职责是对外部漏洞负责，虽然我公司信息安全部有将近50号人，小组是应用运维安全十多人，但是对外部漏洞负责的仅有负责渗透测试我和我导师两人。

理论上讲，为了确保不出现外网漏洞，可以做的事情是：
1. 上线前渗透测试，低成本侵入业务，尽可能发现大部分漏洞尤其是高危漏洞，提高攻击成本
2. 安全运营扫描，对线上业务进行定期、周期扫描，避免增量业务和业务部署维护时对误操作造成对安全漏洞
3. 纵深防御，包括SDL建设、内网检查、WAF、主机检测和日志审计一类的其他安全系统

但是比如红蓝对抗、WAF、主机检测、内网检测等被是其他小组的工作，同时有办公室斗争，不好询问和越界，因此只能做渗透测试和外网扫描，然后SDL建设

#### 绩效设计
在绩效的设计上：
1. 要有持续的产出成果，比如渗透测试，基本每周至少一个版本一份报告，产出发现的漏洞
2. 要产出可维护可运营的系统，很多时候甲方肯定不关心挖了什么厉害的漏洞，重要的是这种案例的漏洞之后是否可以覆盖与防御，定期运营的扫描器、IPS、WAF等就很重要，或者SDL
3. 要有先进的研究工作，有难度的工作，最好价值体现就是做重要不紧急的事，最好能利用公司资源，非自学可以得到的

同时于自己来说，也要归纳工作中重复的点，比如渗透测试的对某个应用定制化的插件是否可以在安全运营的扫描器中重复利用，以达到对业务定制对效果等等，安全运营发现的漏洞案例是否要增加到上线前渗透测试的检查列表中，减少重复和琐碎的工作，多做解决一个问题，完成多份工作的事

#### 绩效如何达标
我们常说安全背锅，没有加分项，只有60分，出事了减分

从我一年的感觉来看，上交的绩效目标，给我打绩效的领导是不会看的，渗透在部门里属于紧急重要的任务，确认有人做了就行了，SRC不上报高危漏洞就算做得没问题，也不能作出突出贡献，领导更关注WAF、风控这样自动化可以一直对公司有贡献的项目，我也常想渗透能作出什么花样才会让领导觉得我有贡献

所以好绩效是很难拿到好绩效的，就怎么样把工作做好吧。

第一是从领导那里争取重视，或者一些支持和帮助。

首先要向领导暴露问题，和自己闷头解决问题，防止漏洞外露不同，我觉得首先要暴露问题。一般来说，跟领导说自己的不足，容易让领导看轻。但是即使是甲方的安全部门，挖漏洞的也像一个乙方一样，对于一些漏洞对整改和业务的配合是需要权威大的人去推动的，因此获得老大的支持和理解很重要，要让他知道自己平时再做什么，我觉得较好的方式是将自己的问题和难点告诉领导，也将自己对这些问题的解决方法和需要的帮助告诉领导，让他参与其中

一般上面想达到的效果就是沟通的效果，但其实还是有差距，因为听者重视不重视，对沟通对结果差距很大，而说出问题更能吸引对方，同时和领导暴露建设中的不足，也能给自己更足够的压力，帮助自己尽快解决这种不足。

第二是认真和积极。

认真打磨自己的工具，把扫描器每个端口扫描、漏洞扫描的覆盖范围提高，渗透的每个功能点认真检查，业务修复漏洞时积极加入，了解业务写出漏洞代码的原因和设计上的不足，帮助业务理解漏洞，正确修复。

这一点靠自己，当然长期如此也会繁琐而且容易觉得没有进步，也未必会被领导重视，但要想尽少出问题，就要尽多认真做，而一些规则和用例的积累也是最重要的

第三是确定责任边界

有合作就有甩锅，安全和漏洞又是一件敏感的事情，发现问题了早些划定谁负责，是自己的认真对待，不是自己早些确定归属，当然，这也看领导是怎么断的。我们做的安全检查是对出现的安全问题提供合适的建议，最后领导和业务决定怎么对待，但不要把问题悬挂在那里，无人认领，这一点做好了也能提高效率，在大公司里相当于优化了流程，能更快找到负责人。

这一点在实际上领导的意思是业务优先，除非高危会帮衬一下，所以目前的状况就是全靠自己花时间去推，漏洞的责任全在渗透人员这里，耗费了大量沟通和请求对方修复的时间。

第四是提出问题是好的，也要多想到解决方法

大意类似漏洞，能发现很好，能想到怎么覆盖这个漏洞更优

最后我的绩效一直一般，这里只是我的一些思考，所以也希望能有高人指点。

#### 难点困惑
一是一句话需求

我的部门没有安全产品经理，按领导|导师|我这样的上下级关系，很多事情是领导有一个大概的构想，然后导师让我来做，绝大多数时候是一句话需求

这个时候，一个系统或者一件事情做成什么样子是没有一个预期的，自己想了半天提了方案想问某个细节，导师和领导的意见往往是关系不大，你自己判断，自己去判断当然想多了解一些，而然甲方公司里处处制肘，想要绕过导师和领导去了解具体的情况是很难的，很多时候连负责人都不知道是谁或者负责人不买账

同样都一句话需求都问题也存在于别都团队都挑刺，很多事情没法做得很完美，肯定有缺陷，当你选择某个有缺陷的方案的时候，办公室斗争会导致别的组指出你的问题，但是从来不会提出解决方案，对缺陷的处理变成了莫名的需求，人微言轻也只能导致跟人对话只有一种无力感，一些建议被否决还是小事，被否决也不会告诉你为什么否决才是难受

自己想方案满足需求本来没有问题，但是信息量的差距会让工作上重重受阻，这是我在一年间遇到的最大的也是最无解的问题，感觉好多时间被这种问题消耗

二是资源利用的问题

当年我来工作的时候，组里一共6个人，一个我，一个上届应届生，其他都是腾讯呆了5年以上的人，公司整个的技术部门绝大多数都是从腾讯挖来的，本来想着可以来好好学习

但实际工作中，导师们相当于派活的角色，就是上面的一句话需求，当自己遇到难题，导师们并没有解决方案，学习全靠自己，没有导师们经验资源的利用，可能导师们也只是在腾讯当了好多年基层吧

工作中基本没有合作，不管小组还是和别的部门，本来有些系统和事情可以让专门负责的部门来做，但是出于各种不愿共享信息的理由，或者导师们为了增多了绩效的目标数量和抢活，也做了很多无意义的工作

比如很多东西只有一期，能跑就行，不要文档和优化，往往负责人离职就要重新做，事实上我已经改了几个之前离职的人做的项目，基本上和重做一样

比如整个公司内技术的基础建设完全用不到，什么语言、数据库、日志系统、MQ都要预研、自研，一个组，每人做两三个项目，都用不同技术，产品、开发、测试、运维全是自己

再比如类似工单系统，开发有自己的工单系统，安全也要重新做一个维护，就强行为了绩效了，实际上完全可以融入开发的系统，让他们系统的维护者将我们的漏洞工单作为bug单一样用

三是自身的优势和方向

安全很广很杂，除了大学里的密码学知识、渗透和扫描器开发，我做的大部分事情都是杂货，应该说面广了，但不够深入，攻击或者防御，未来的方向和自身的优势是更要思考的问题

### 渗透测试思考
不谈渗透测试中遇到的最大问题，也就是业务优先，业务方不配合的问题，单单谈渗透测试本身

这一年觉得渗透测试中，如果要提升渗透测试效果，对漏洞的理解和对渗透测试检查列表的维护至关重要，也就是深度和广度

#### 对漏洞对理解

作为一个大学里开发过Web系统的人，觉得类似SQL注入一类的漏洞真的很好理解，但是知道字符串拼接不代表理解SQL原理了，预编译是哪一层做的预编译（程序代码还是数据库本身），MySQL的协议是怎么样的，程序到底是怎么和MySQL交互的，《白帽子讲Web安全》里把数据段当代码段执行在每一种注入漏洞里数据段和代码段究竟在哪个位置，

发现漏洞时候很多开发也知道SQL注入，但是仍然会写出SQL注入，为什么明知道还会写这些也是要研究的地方，其实也很能容易就知道预编译对ORDER BY、GROUP BY语法对影响，一些ORM库使用时对程序员来说不如原生SQL拼接更有效率

然后是发现SQL注入怎么利用，怎么提权的问题

这里有三点，需要尽可能做好

1. 漏洞原理越深入越好
2. 开发时写出漏洞的原因是什么
3. 漏洞的深层利用

在我的实际工作中我会尽量去了解1和2，基本不涉及3

1往往是看的文章博客能写多深自己能了解多深，有很多时候少了主观发观原因的思路和进一步探究的进取，计算机是层层封装的，很多东西在某一层时就会感觉自己知道了，但是底层可能还有可以发掘的地方没有发现，这也是自己的不足和需要进步的地方

2也有时候看开发配合不配合，大部分情况下我也能追问到一些产生奇怪漏洞的原因

3在甲方工作中基本上有漏洞发现立刻叫修，不会深层去利用，但是感觉渗透测试在如何利用上去研究会有更大的进步，这是我觉得自己渗透中做得最不足的地方，也是最需要改进的方向

#### 渗透测试列表维护
能不能找出漏洞有能力的高低，但是大部分情况下，就甲方来说，一个较为完整的检查列表可以保证即时水平不高或者刚入行的渗透人员（比如我）也能作出较为全面的渗透测试

这里也有两个方面

1. 检查列表按模块划分的漏洞类型要多
2. 检查的接口要真正覆盖

第一个方面上我以《黑客攻防技术宝典——黑客实战篇》把渗透检查分为几个模块，再细化每个模块要检查的漏洞类型和用例，这里类似运营，靠的是不断维护和积累

![1](https://milkfr.github.io/assets/images/posts/2018-07-29-summary-of-the-first-year/1.png)

第二个方面在我实际工作中表现在一些业务接口的设计上，有CSRF_Token防御，有参数签名校验和登录态访问过多过快就过期的问题等等，使用扫描器去扫描必然没有效果，大部分扫描没有绕过这些防御的机制，无法触及到业务逻辑

一年中为了重新获取CSRF Token，重签名，判断扫描是否有效写了很多Burp Suite插件，因为甲方可以直接找开发要一些资料，这能比单纯扫描多发现不少问题，尽可能确保每一个经过自己手上的接口是被检查规则覆盖的，认真检查让检查规则有效也是非常重要的一环

### 安全运营思考


### 总结
应届生校招，选择一个觉得问问题问得有水平的面试官的公司，其实是我当年对道对追求太高了，年轻人还是多注重术，注重技巧，注重积累
